üîç Environment check:
NODE_ENV: development
DATABASE_URL exists: false
DB_HOST: localhost
‚ö†Ô∏è DATABASE_URL not found, using fallback configuration
Executing (default): SELECT 1+1 AS result
‚úì Database connection established successfully
Executing (default): SELECT table_name FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'users'
Executing (default): SELECT t.typname enum_name, array_agg(e.enumlabel ORDER BY enumsortorder) enum_value FROM pg_type t JOIN pg_enum e ON t.oid = e.enumtypid JOIN pg_catalog.pg_namespace n ON n.oid = t.typnamespace WHERE n.nspname = 'public' AND t.typname='enum_users_role' GROUP BY 1
Executing (default): SELECT i.relname AS name, ix.indisprimary AS primary, ix.indisunique AS unique, ix.indkey AS indkey, array_agg(a.attnum) as column_indexes, array_agg(a.attname) AS column_names, pg_get_indexdef(ix.indexrelid) AS definition FROM pg_class t, pg_class i, pg_index ix, pg_attribute a WHERE t.oid = ix.indrelid AND i.oid = ix.indexrelid AND a.attrelid = t.oid AND t.relkind = 'r' and t.relname = 'users' GROUP BY i.relname, ix.indexrelid, ix.indisprimary, ix.indisunique, ix.indkey ORDER BY i.relname;
Executing (default): SELECT table_name FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'properties'
Executing (default): SELECT t.typname enum_name, array_agg(e.enumlabel ORDER BY enumsortorder) enum_value FROM pg_type t JOIN pg_enum e ON t.oid = e.enumtypid JOIN pg_catalog.pg_namespace n ON n.oid = t.typnamespace WHERE n.nspname = 'public' AND t.typname='enum_properties_property_type' GROUP BY 1
Executing (default): SELECT t.typname enum_name, array_agg(e.enumlabel ORDER BY enumsortorder) enum_value FROM pg_type t JOIN pg_enum e ON t.oid = e.enumtypid JOIN pg_catalog.pg_namespace n ON n.oid = t.typnamespace WHERE n.nspname = 'public' AND t.typname='enum_properties_construction_type' GROUP BY 1
Executing (default): SELECT t.typname enum_name, array_agg(e.enumlabel ORDER BY enumsortorder) enum_value FROM pg_type t JOIN pg_enum e ON t.oid = e.enumtypid JOIN pg_catalog.pg_namespace n ON n.oid = t.typnamespace WHERE n.nspname = 'public' AND t.typname='enum_properties_survey_status' GROUP BY 1
Executing (default): SELECT t.typname enum_name, array_agg(e.enumlabel ORDER BY enumsortorder) enum_value FROM pg_type t JOIN pg_enum e ON t.oid = e.enumtypid JOIN pg_catalog.pg_namespace n ON n.oid = t.typnamespace WHERE n.nspname = 'public' AND t.typname='enum_properties_approval_status' GROUP BY 1
Executing (default): SELECT i.relname AS name, ix.indisprimary AS primary, ix.indisunique AS unique, ix.indkey AS indkey, array_agg(a.attnum) as column_indexes, array_agg(a.attname) AS column_names, pg_get_indexdef(ix.indexrelid) AS definition FROM pg_class t, pg_class i, pg_index ix, pg_attribute a WHERE t.oid = ix.indrelid AND i.oid = ix.indexrelid AND a.attrelid = t.oid AND t.relkind = 'r' and t.relname = 'properties' GROUP BY i.relname, ix.indexrelid, ix.indisprimary, ix.indisunique, ix.indkey ORDER BY i.relname;
Executing (default): SELECT table_name FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'property_images'
Executing (default): SELECT t.typname enum_name, array_agg(e.enumlabel ORDER BY enumsortorder) enum_value FROM pg_type t JOIN pg_enum e ON t.oid = e.enumtypid JOIN pg_catalog.pg_namespace n ON n.oid = t.typnamespace WHERE n.nspname = 'public' AND t.typname='enum_property_images_image_type' GROUP BY 1
Executing (default): SELECT i.relname AS name, ix.indisprimary AS primary, ix.indisunique AS unique, ix.indkey AS indkey, array_agg(a.attnum) as column_indexes, array_agg(a.attname) AS column_names, pg_get_indexdef(ix.indexrelid) AS definition FROM pg_class t, pg_class i, pg_index ix, pg_attribute a WHERE t.oid = ix.indrelid AND i.oid = ix.indexrelid AND a.attrelid = t.oid AND t.relkind = 'r' and t.relname = 'property_images' GROUP BY i.relname, ix.indexrelid, ix.indisprimary, ix.indisunique, ix.indkey ORDER BY i.relname;
‚úì Database models synchronized (no alterations)
üöÄ Server running on port 3000
üìä Environment: development
üîó Health check: http://localhost:3000/health
üìù API Docs: http://localhost:3000/api
[0mGET /health [32m200[0m 1.566 ms - 163[0m
Executing (default): SELECT "id", "employee_id", "first_name", "last_name", "email", "phone", "role", "department", "assigned_area", "is_active", "last_login", "created_at" AS "createdAt", "updated_at" AS "updatedAt" FROM "users" AS "User" WHERE "User"."id" = 'b6cf71db-f6de-42a1-9a83-faed65fae56c';
Executing (default): SELECT count("Property"."id") AS "count" FROM "properties" AS "Property" LEFT OUTER JOIN "users" AS "surveyor" ON "Property"."surveyed_by" = "surveyor"."id" WHERE "Property"."approval_status" = 'pending_approval';
Executing (default): SELECT "Property"."id", "Property"."survey_number", "Property"."old_mc_property_number", "Property"."register_no", "Property"."owner_name", "Property"."owner_father_name", "Property"."owner_phone", "Property"."owner_email", "Property"."aadhar_number", "Property"."house_number", "Property"."street_name", "Property"."locality", "Property"."ward_number", "Property"."pincode", "Property"."zone", "Property"."property_type", "Property"."construction_type", "Property"."construction_year", "Property"."number_of_floors", "Property"."building_permission", "Property"."bp_number", "Property"."bp_date", "Property"."plot_area", "Property"."built_up_area", "Property"."carpet_area", "Property"."property_use_details", "Property"."water_connection", "Property"."water_connection_number", "Property"."water_connection_date", "Property"."electricity_connection", "Property"."electricity_connection_number", "Property"."sewage_connection", "Property"."solar_panel", "Property"."rain_water_harvesting", "Property"."latitude", "Property"."longitude", "Property"."owner_tenant_photo", "Property"."signature_data", "Property"."sketch_photo", "Property"."sketch_photo_captured_at", "Property"."assessment_year", "Property"."estimated_tax", "Property"."survey_status", "Property"."approval_status", "Property"."approved_by", "Property"."approved_at", "Property"."rejection_reason", "Property"."admin_notes", "Property"."remarks", "Property"."surveyed_by", "Property"."reviewed_by", "Property"."review_remarks", "Property"."survey_date", "Property"."last_edit_comment", "Property"."last_edit_date", "Property"."last_edit_by", "Property"."edit_count", "Property"."created_at" AS "createdAt", "Property"."updated_at" AS "updatedAt", "surveyor"."id" AS "surveyor.id", "surveyor"."first_name" AS "surveyor.first_name", "surveyor"."last_name" AS "surveyor.last_name", "surveyor"."employee_id" AS "surveyor.employee_id", "surveyor"."role" AS "surveyor.role" FROM "properties" AS "Property" LEFT OUTER JOIN "users" AS "surveyor" ON "Property"."surveyed_by" = "surveyor"."id" WHERE "Property"."approval_status" = 'pending_approval' ORDER BY "createdAt" DESC LIMIT 20 OFFSET 0;
[0mGET /api/admin/pending-approvals [32m200[0m 107.380 ms - 74950[0m
Executing (default): SELECT "id", "employee_id", "first_name", "last_name", "email", "phone", "role", "department", "assigned_area", "is_active", "last_login", "created_at" AS "createdAt", "updated_at" AS "updatedAt" FROM "users" AS "User" WHERE "User"."id" = 'b6cf71db-f6de-42a1-9a83-faed65fae56c';
Executing (default): SELECT count(*) AS "count" FROM "properties" AS "Property" WHERE "Property"."zone" = 'A' AND "Property"."approval_status" = 'pending_approval';
Executing (default): SELECT count(*) AS "count" FROM "properties" AS "Property" WHERE "Property"."zone" = 'A' AND "Property"."approval_status" = 'approved';
Executing (default): SELECT count(*) AS "count" FROM "properties" AS "Property" WHERE "Property"."zone" = 'A' AND "Property"."approval_status" = 'rejected';
Executing (default): SELECT count(*) AS "count" FROM "properties" AS "Property" WHERE "Property"."zone" = 'A';
Executing (default): SELECT "zone", "approval_status", COUNT("id") AS "count" FROM "properties" AS "Property" WHERE "Property"."zone" = 'A' GROUP BY "zone", "approval_status" ORDER BY "Property"."zone" ASC;
Executing (default): SELECT "property_type", "approval_status", COUNT("id") AS "count" FROM "properties" AS "Property" WHERE "Property"."zone" = 'A' GROUP BY "property_type", "approval_status" ORDER BY "Property"."property_type" ASC;
[0mGET /api/admin/approval-stats?zone=A [32m200[0m 35.912 ms - 295[0m
Executing (default): SELECT "id", "employee_id", "first_name", "last_name", "email", "phone", "role", "department", "assigned_area", "is_active", "last_login", "created_at" AS "createdAt", "updated_at" AS "updatedAt" FROM "users" AS "User" WHERE "User"."id" = 'b6cf71db-f6de-42a1-9a83-faed65fae56c';
Executing (default): SELECT "id", "survey_number", "old_mc_property_number", "register_no", "owner_name", "owner_father_name", "owner_phone", "owner_email", "aadhar_number", "house_number", "street_name", "locality", "ward_number", "pincode", "zone", "property_type", "construction_type", "construction_year", "number_of_floors", "building_permission", "bp_number", "bp_date", "plot_area", "built_up_area", "carpet_area", "property_use_details", "water_connection", "water_connection_number", "water_connection_date", "electricity_connection", "electricity_connection_number", "sewage_connection", "solar_panel", "rain_water_harvesting", "latitude", "longitude", "owner_tenant_photo", "signature_data", "sketch_photo", "sketch_photo_captured_at", "assessment_year", "estimated_tax", "survey_status", "approval_status", "approved_by", "approved_at", "rejection_reason", "admin_notes", "remarks", "surveyed_by", "reviewed_by", "review_remarks", "survey_date", "last_edit_comment", "last_edit_date", "last_edit_by", "edit_count", "created_at" AS "createdAt", "updated_at" AS "updatedAt" FROM "properties" AS "Property" WHERE "Property"."id" = '363e7dc8-282e-4668-a8cb-c70b8179b6b1';
Executing (default): UPDATE "properties" SET "approval_status"=$1,"approved_by"=$2,"approved_at"=$3,"admin_notes"=$4,"survey_status"=$5,"updated_at"=$6 WHERE "id" = $7
[0mPOST /api/admin/approve/363e7dc8-282e-4668-a8cb-c70b8179b6b1 [32m200[0m 59.770 ms - 291[0m
Executing (default): SELECT "id", "employee_id", "first_name", "last_name", "email", "phone", "role", "department", "assigned_area", "is_active", "last_login", "created_at" AS "createdAt", "updated_at" AS "updatedAt" FROM "users" AS "User" WHERE "User"."id" = 'b6cf71db-f6de-42a1-9a83-faed65fae56c';
Executing (default): SELECT "id", "survey_number", "old_mc_property_number", "register_no", "owner_name", "owner_father_name", "owner_phone", "owner_email", "aadhar_number", "house_number", "street_name", "locality", "ward_number", "pincode", "zone", "property_type", "construction_type", "construction_year", "number_of_floors", "building_permission", "bp_number", "bp_date", "plot_area", "built_up_area", "carpet_area", "property_use_details", "water_connection", "water_connection_number", "water_connection_date", "electricity_connection", "electricity_connection_number", "sewage_connection", "solar_panel", "rain_water_harvesting", "latitude", "longitude", "owner_tenant_photo", "signature_data", "sketch_photo", "sketch_photo_captured_at", "assessment_year", "estimated_tax", "survey_status", "approval_status", "approved_by", "approved_at", "rejection_reason", "admin_notes", "remarks", "surveyed_by", "reviewed_by", "review_remarks", "survey_date", "last_edit_comment", "last_edit_date", "last_edit_by", "edit_count", "created_at" AS "createdAt", "updated_at" AS "updatedAt" FROM "properties" AS "Property" WHERE "Property"."id" = '61d5eb33-375f-4f17-903e-dd672cc102f8';
Executing (default): UPDATE "properties" SET "approval_status"=$1,"approved_by"=$2,"approved_at"=$3,"rejection_reason"=$4,"admin_notes"=$5,"survey_status"=$6,"updated_at"=$7 WHERE "id" = $8
[0mPOST /api/admin/reject/61d5eb33-375f-4f17-903e-dd672cc102f8 [32m200[0m 6.158 ms - 349[0m
Executing (default): SELECT "id", "employee_id", "first_name", "last_name", "email", "phone", "role", "department", "assigned_area", "is_active", "last_login", "created_at" AS "createdAt", "updated_at" AS "updatedAt" FROM "users" AS "User" WHERE "User"."id" = 'b6cf71db-f6de-42a1-9a83-faed65fae56c';
Executing (default): SELECT count(*) AS "count" FROM "properties" AS "Property" WHERE "Property"."approval_status" = 'pending_approval';
Executing (default): SELECT count(*) AS "count" FROM "properties" AS "Property" WHERE "Property"."approval_status" = 'approved';
Executing (default): SELECT count(*) AS "count" FROM "properties" AS "Property" WHERE "Property"."approval_status" = 'rejected';
Executing (default): SELECT count(*) AS "count" FROM "properties" AS "Property";
Executing (default): SELECT "zone", "approval_status", COUNT("id") AS "count" FROM "properties" AS "Property" GROUP BY "zone", "approval_status" ORDER BY "Property"."zone" ASC;
Executing (default): SELECT "property_type", "approval_status", COUNT("id") AS "count" FROM "properties" AS "Property" GROUP BY "property_type", "approval_status" ORDER BY "Property"."property_type" ASC;
[0mGET /api/admin/approval-stats [32m200[0m 7.496 ms - 612[0m
[0mGET /api/admin/approval-stats [33m401[0m 0.838 ms - 51[0m
Executing (default): SELECT "id", "employee_id", "first_name", "last_name", "email", "phone", "role", "department", "assigned_area", "is_active", "last_login", "created_at" AS "createdAt", "updated_at" AS "updatedAt" FROM "users" AS "User" WHERE "User"."id" = 'b6cf71db-f6de-42a1-9a83-faed65fae56c';
Executing (default): SELECT count(*) AS "count" FROM "properties" AS "Property" WHERE "Property"."approval_status" = 'pending_approval';
Executing (default): SELECT count(*) AS "count" FROM "properties" AS "Property" WHERE "Property"."approval_status" = 'approved';
Executing (default): SELECT count(*) AS "count" FROM "properties" AS "Property" WHERE "Property"."approval_status" = 'rejected';
Executing (default): SELECT count(*) AS "count" FROM "properties" AS "Property";
Executing (default): SELECT "zone", "approval_status", COUNT("id") AS "count" FROM "properties" AS "Property" GROUP BY "zone", "approval_status" ORDER BY "Property"."zone" ASC;
Executing (default): SELECT "property_type", "approval_status", COUNT("id") AS "count" FROM "properties" AS "Property" GROUP BY "property_type", "approval_status" ORDER BY "Property"."property_type" ASC;
[0mGET /api/admin/approval-stats [32m200[0m 88.566 ms - 612[0m
Executing (default): SELECT "id", "employee_id", "first_name", "last_name", "email", "phone", "role", "department", "assigned_area", "is_active", "last_login", "created_at" AS "createdAt", "updated_at" AS "updatedAt" FROM "users" AS "User" WHERE "User"."id" = 'b6cf71db-f6de-42a1-9a83-faed65fae56c';
Executing (default): SELECT count("Property"."id") AS "count" FROM "properties" AS "Property" LEFT OUTER JOIN "users" AS "surveyor" ON "Property"."surveyed_by" = "surveyor"."id" WHERE "Property"."approval_status" = 'pending_approval';
Executing (default): SELECT "Property"."id", "Property"."survey_number", "Property"."old_mc_property_number", "Property"."register_no", "Property"."owner_name", "Property"."owner_father_name", "Property"."owner_phone", "Property"."owner_email", "Property"."aadhar_number", "Property"."house_number", "Property"."street_name", "Property"."locality", "Property"."ward_number", "Property"."pincode", "Property"."zone", "Property"."property_type", "Property"."construction_type", "Property"."construction_year", "Property"."number_of_floors", "Property"."building_permission", "Property"."bp_number", "Property"."bp_date", "Property"."plot_area", "Property"."built_up_area", "Property"."carpet_area", "Property"."property_use_details", "Property"."water_connection", "Property"."water_connection_number", "Property"."water_connection_date", "Property"."electricity_connection", "Property"."electricity_connection_number", "Property"."sewage_connection", "Property"."solar_panel", "Property"."rain_water_harvesting", "Property"."latitude", "Property"."longitude", "Property"."owner_tenant_photo", "Property"."signature_data", "Property"."sketch_photo", "Property"."sketch_photo_captured_at", "Property"."assessment_year", "Property"."estimated_tax", "Property"."survey_status", "Property"."approval_status", "Property"."approved_by", "Property"."approved_at", "Property"."rejection_reason", "Property"."admin_notes", "Property"."remarks", "Property"."surveyed_by", "Property"."reviewed_by", "Property"."review_remarks", "Property"."survey_date", "Property"."last_edit_comment", "Property"."last_edit_date", "Property"."last_edit_by", "Property"."edit_count", "Property"."created_at" AS "createdAt", "Property"."updated_at" AS "updatedAt", "surveyor"."id" AS "surveyor.id", "surveyor"."first_name" AS "surveyor.first_name", "surveyor"."last_name" AS "surveyor.last_name", "surveyor"."employee_id" AS "surveyor.employee_id", "surveyor"."role" AS "surveyor.role" FROM "properties" AS "Property" LEFT OUTER JOIN "users" AS "surveyor" ON "Property"."surveyed_by" = "surveyor"."id" WHERE "Property"."approval_status" = 'pending_approval' ORDER BY "createdAt" DESC LIMIT 20 OFFSET 0;
[0mGET /api/admin/pending-approvals [32m200[0m 23.554 ms - 38518[0m
